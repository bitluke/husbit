<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/security
           http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <!--excluding resources from authentication-->
    <!--    <http pattern="/resources/*" security="none"/>-->
    <!--    <http pattern="/login.xhtml*"  security="none"/>-->

    <debug/>

    <http auto-config="true">

        <!--configuration of URL for authorization works from top to bottom i.e a more specific url matches first be-->
        <!--before a generic one-->
        <intercept-url pattern="/" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
        <intercept-url pattern="/index.xhtml" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
        <intercept-url pattern="/login.xhtml*" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
        <intercept-url pattern="/user/*" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
        <intercept-url pattern="/*" access="ROLE_ADMIN"/>
        <!--login page -->
        <form-login password-parameter="j_password_input" login-page="/login.xhtml"
                    default-target-url="/home.xhtml" always-use-default-target="true"/>
        <!--controls logout of principal-->
        <logout delete-cookies="JSESSIONID" logout-success-url="/logout.xhtml"/>
        <!-- for invalid session management -->
        <session-management invalid-session-url="/invalidSession.xhtml"/>
        <!--configure remember me  -->
        <remember-me/>
    </http>

    <authentication-manager alias="authenticationManager">
        <authentication-provider user-service-ref="jdbcUserService" >
            <!--Using Standard password Encoder-->
            <password-encoder ref="passEncoder"/>
        </authentication-provider>
    </authentication-manager>


</beans:beans>
